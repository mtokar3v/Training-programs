<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="css/navbar.css" type="text/css"/>
	<link rel="stylesheet" href="css/notes.css" type="text/css"/>
	<title>laba1</title>
</head>
<body>
	<div class="wrapper">
		<div class="navbar">
			<nav>
				<ul>
					<li><a href="article.html">Статья</a></li>
					<li><a href="statistics.html">Статистика</a></li>
					<li class="active"><a href="notes.html">Заметки</a></li>
					<li><a href="form.html">Анкета</a></li>
				</ul>
			</nav>
		</div>
		<div class="content">
			<div class="node" draggable="true">
				<h3>Заметка</h3>
				<textarea placeholder="Введите текст..." rows="15" cols="20"></textarea>
			</div>
			<div class="node" draggable="true">
				<h3>Заметка</h3>
				<textarea placeholder="Введите текст..." rows="15" cols="20"></textarea>
			</div>
			<div class="node" draggable="true">
				<h3>Заметка</h3>
				<textarea placeholder="Введите текст..." rows="15" cols="20"></textarea>
			</div>
			<div class="node" draggable="true">
				<h3>Заметка</h3>
				<textarea placeholder="Введите текст..." rows="15" cols="20"></textarea>
			</div>
			<div class="node" draggable="true">
				<h3>Заметка</h3>
				<textarea placeholder="Введите текст..." rows="15" cols="20"></textarea>
			</div>
			<div class="node" draggable="true">
				<h3>Заметка</h3>
				<textarea placeholder="Введите текст..." rows="15" cols="20"></textarea>
			</div>
			<div class="node" draggable="true">
				<h3>Заметка</h3>
				<textarea placeholder="Введите текст..." rows="15" cols="20"></textarea>
			</div>
		</div>
	</div>
</body>

<script type="text/javascript">
	let container = document.getElementsByClassName('content')[0];
	let nodes = document.getElementsByClassName("node");
	
	container.addEventListener('dragstart', (event)=>{
		event.target.classList.add('selected');
	});

	container.addEventListener('dragend', (event)=>{
		event.target.classList.remove('selected');
	});

	container.addEventListener('dragover', (event)=>{
		event.preventDefault();

		let active = container.getElementsByClassName('selected')[0];

		let current = event.target;

		if(current.tagName != 'DIV')
			current = event.target.parentNode;

		let isMoveble = active !== current && current.classList.contains('node'); 

		if(!isMoveble)
			return;

		let next = getNextElement(event.clientX ,event.clientY, current);

		if (next && active === next.previousElementSibling || active === next) {
		    return;
	  	}

		container.insertBefore(active, next);
	});

	const getNextElement = (cursorPositionX,cursorPositionY, currentElement) => {

	  	const currentElementCoord = currentElement.getBoundingClientRect();
	  
	  	const currentElementCenterY = currentElementCoord.y + currentElementCoord.height / 2;
	  	const currentElementCenterX = currentElementCoord.x + currentElementCoord.width / 2;

	  
	  	const nextElement = (cursorPositionY < currentElementCenterY && cursorPositionX < currentElementCenterX) ? currentElement : currentElement.nextElementSibling;

	  	return nextElement;
	};
</script>
</html>